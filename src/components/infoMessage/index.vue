<template>
  <div class="left1">
    <div class="line">
      <div class="info"></div>
    </div>
  </div>
  <div class="left2">
    <div class="radar">
      <div class="fan"></div>
    </div>
  </div>
  <div class="right1">
    <div class="content">
      <span id="infoText"></span>
      <svg
        class="svg"
        xmlns="http://www.w3.org/2000/svg"
        xmlns:xlink="http://www.w3.org/1999/xlink"
        fill="none"
        version="1.1"
        width="129.6943359375"
        height="135"
        viewBox="0 0 200 200"
      >
        <defs>
          <filter
            id="master_svg0_66_1997"
            filterUnits="objectBoundingBox"
            color-interpolation-filters="sRGB"
            x="-12"
            y="-12"
            width="73"
            height="48"
          >
            <feFlood flood-opacity="0" result="BackgroundImageFix" />
            <feColorMatrix
              in="SourceAlpha"
              type="matrix"
              values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0"
            />
            <feOffset dy="0" dx="0" />
            <feGaussianBlur stdDeviation="3" />
            <feColorMatrix
              type="matrix"
              values="0 0 0 0 0 0 0 0 0 0.7490196228027344 0 0 0 0 1 0 0 0 0.6000000238418579 0"
            />
            <feBlend mode="normal" in2="BackgroundImageFix" result="effect1_dropShadow" />
            <feBlend mode="normal" in="SourceGraphic" in2="effect1_dropShadow" result="shape" />
          </filter>
        </defs>
        <g>
          <g>
            <path d="" fill="#D8D8D8" fill-opacity="1" />
            <path
              d="M16.1276796875,21.31464462890625Q6.9965096875,30.43504462890625,1.9883406875,42.26164462890625L3.8300186875,43.04154462890625Q8.6859996875,31.57434462890625,17.5410796875,22.72974462890625Q26.3962796875,13.88494462890625,37.8774796875,9.03463462890625Q49.7633796875,4.01325462890625,62.7804796875,4.01324462890625Q75.7975796875,4.01324462890625,87.6835796875,9.03462462890625Q99.1646796875,13.88494462890625,108.0201796875,22.72974462890625Q116.8751796875,31.57424462890625,121.7311796875,43.04154462890625Q126.7581796875,54.91284462890625,126.7581796875,67.91394462890625Q126.7581796875,80.91494462890626,121.7311796875,92.78624462890625Q116.8751796875,104.25324462890624,108.0201796875,113.09824462890624Q99.1645796875,121.94324462890626,87.6835796875,126.79324462890625Q75.7975796875,131.81424462890624,62.7804796875,131.81424462890624Q49.7633796875,131.81424462890624,37.8774796875,126.79324462890625Q26.3963796875,121.94324462890626,17.5410796875,113.09824462890624Q8.6859996875,104.25324462890624,3.8300186875,92.78624462890625L1.9883406875,93.56614462890624Q6.9965096875,105.39324462890625,16.1276796875,114.51324462890625Q25.2587796875,123.63324462890625,37.0991796875,128.63524462890626Q49.3582796875,133.81424462890624,62.7804796875,133.81424462890624Q76.2026796875,133.81424462890624,88.4618796875,128.63524462890626Q100.3020796875,123.63324462890625,109.4331796875,114.51324462890625Q118.5641796875,105.39324462890625,123.5721796875,93.56614462890624Q128.7581796875,81.32094462890625,128.7581796875,67.91394462890625Q128.7581796875,54.50674462890625,123.5721796875,42.26164462890625Q118.5641796875,30.43504462890625,109.4331796875,21.31464462890625Q100.3020796875,12.19434462890625,88.4618796875,7.19229462890625Q76.2026796875,2.01324462890625,62.7804796875,2.01324662890625Q49.3582796875,2.01324862890625,37.0991796875,7.19229462890625Q25.2587796875,12.19439462890625,16.1276796875,21.31464462890625Z"
              fill-rule="evenodd"
              fill="#314951"
              fill-opacity="1"
            />
          </g>
          <g>
            <path d="" fill="#FFFFFF" fill-opacity="1" />
            <path
              d="M22.3019609375,26.91338095703125Q14.2761809375,34.93828095703125,9.8744669375,45.34398095703125L10.7954549375,45.73358095703125Q15.1211809375,35.50748095703125,23.0090609375,27.62058095703125Q30.8969609375,19.733550957031248,41.124060937500005,15.40832095703125Q51.7120609375,10.93048095703125,63.3069609375,10.93048295703125Q74.9018609375,10.93048095703125,85.4898609375,15.40832095703125Q95.7167609375,19.73350095703125,103.6049609375,27.62058095703125Q111.4929609375,35.507380957031245,115.8189609375,45.73358095703125Q120.2969609375,56.32048095703125,120.2969609375,67.91388095703125Q120.2969609375,79.50748095703125,115.8189609375,90.09428095703124Q111.4929609375,100.32048095703125,103.6049609375,108.20728095703124Q95.7166609375,116.09448095703125,85.4898609375,120.41948095703125Q74.9018609375,124.89748095703125,63.3069609375,124.89748095703125Q51.7122609375,124.89748095703125,41.124060937500005,120.41948095703125Q30.8970609375,116.09448095703125,23.0090609375,108.20728095703124Q15.1211809375,100.32038095703125,10.7954549375,90.09428095703124L9.8744669375,90.48388095703125Q14.2762109375,100.88948095703125,22.3019609375,108.91438095703126Q30.3279609375,116.93948095703125,40.7345609375,121.34048095703125Q51.5095609375,125.89748095703125,63.3069609375,125.89748095703125Q75.1044609375,125.89748095703125,85.8793609375,121.34048095703125Q96.2857609375,116.93948095703125,104.3119609375,108.91438095703126Q112.3379609375,100.88968095703125,116.7399609375,90.48388095703125Q121.2969609375,79.71028095703124,121.2969609375,67.91388095703125Q121.2969609375,56.11758095703125,116.7399609375,45.34398095703125Q112.3379609375,34.93818095703125,104.3119609375,26.91338095703125Q96.2859609375,18.88844095703125,85.8793609375,14.48730095703125Q75.1046609375,9.93048095703125,63.3069609375,9.93048295703125Q51.5093609375,9.93048095703125,40.7345609375,14.48730095703125Q30.3277609375,18.88852095703125,22.3019609375,26.91338095703125Z"
              fill-rule="evenodd"
              fill="#5C7A84"
              fill-opacity="1"
            />
          </g>
          <g filter="url(#master_svg0_66_1997)">
            <path
              d="M52.285196875,77.16753051757813L49.876956875,77.16753051757813L44.761716875,70.98003051757813Q44.498046875,70.65483051757812,44.401366875,70.47023051757813L44.357416875,70.47023051757813L44.357416875,77.16753051757813L42.599606875,77.16753051757813L42.599606875,63.55325051757812L44.357416875,63.55325051757812L44.357416875,69.96043051757812L44.401366875,69.96043051757812Q44.550776875,69.72313051757813,44.761716875,69.45953051757813L49.701176875,63.55325051757812L51.872096875,63.55325051757812L46.159176875,70.08353051757813L52.285196875,77.16753051757813ZM64.183396875,77.16753051757813L62.469596875,77.16753051757813L62.469596875,71.63923051757813Q62.469596875,68.64213051757812,60.281096875,68.64213051757812Q59.147296874999995,68.64213051757812,58.417796875,69.48583051757812Q57.688296875,70.32963051757812,57.688296875,71.62163051757813L57.688296875,77.16753051757813L55.965696875,77.16753051757813L55.965696875,67.44681051757813L57.688296875,67.44681051757813L57.688296875,69.05523051757812L57.723496874999995,69.05523051757812Q58.822096875,67.21829051757813,60.913896875,67.21829051757813Q62.513496875,67.21829051757813,63.348496874999995,68.24223051757812Q64.183396875,69.26613051757812,64.183396875,71.22613051757813L64.183396875,77.16753051757813ZM68.567096875,72.41263051757812Q68.567096875,70.00443051757813,69.911796875,68.61133051757812Q71.256496875,67.21829051757813,73.559296875,67.21829051757813Q75.747696875,67.21829051757813,76.99139687499999,68.55863051757812Q78.23499687500001,69.89893051757812,78.23499687500001,72.26323051757812Q78.23499687500001,74.56593051757812,76.907896875,75.98103051757812Q75.580696875,77.39603051757813,73.348296875,77.39603051757813Q71.16859687499999,77.39603051757813,69.867896875,76.02493051757813Q68.567096875,74.65383051757813,68.567096875,72.41263051757812ZM70.32489687500001,72.35993051757812Q70.32489687500001,74.03863051757813,71.172996875,75.00543051757813Q72.021196875,75.97223051757813,73.453796875,75.97223051757813Q74.930396875,75.97223051757813,75.703796875,75.02733051757812Q76.477196875,74.08253051757812,76.477196875,72.31593051757812Q76.477196875,70.54053051757812,75.703796875,69.59133051757813Q74.930396875,68.64213051757812,73.453796875,68.64213051757812Q72.003596875,68.64213051757812,71.164196875,69.63533051757813Q70.32489687500001,70.62843051757812,70.32489687500001,72.35993051757812ZM87.487796875,77.07083051757812Q86.925296875,77.37843051757812,85.967296875,77.37843051757812Q83.356996875,77.37843051757812,83.356996875,74.48683051757813L83.356996875,68.87063051757812L81.686996875,68.87063051757812L81.686996875,67.44681051757813L83.356996875,67.44681051757813L83.356996875,65.10892051757813L85.070796875,64.56399051757812L85.070796875,67.44681051757813L87.487796875,67.44681051757813L87.487796875,68.87063051757812L85.070796875,68.87063051757812L85.070796875,74.17923051757813Q85.070796875,75.13723051757813,85.39599687500001,75.55033051757812Q85.721196875,75.96343051757813,86.477096875,75.96343051757813Q87.057196875,75.96343051757813,87.487796875,75.63823051757812L87.487796875,77.07083051757812Z"
              fill="#FFFFFF"
              fill-opacity="1"
            />
          </g>
          <g>
            <circle id="move" cx="63" cy="68" r="65" stroke="#3bffa7"></circle>
          </g>
        </g>
      </svg>
      <div class="process">
        <div class="info"></div>
      </div>
    </div>
  </div>
  <div class="right2">
    <process2 :num="value1" class="item1"></process2>
    <process2 :num="value2" class="item2"></process2>
    <process2 :num="value3" class="item3"></process2>
  </div>
</template>

<script setup>
import { CountUp } from 'countup.js'
import process2 from './process.vue'
import { useCounterStore } from '@/stores/counter.js'
const value3 = ref(0)
const value2 = ref(9)
const value1 = ref(0)
const store = useCounterStore()
let v1 = null
let v2 = null
let v3 = null
watch(
  () => store.currentMenu,
  (newV) => {
    if (newV == 2) {
      v3 = setInterval(() => {
        value3.value >= 4 ? (value3.value = 4) : value3.value++
      }, 1000)
    }
    if (newV == 3) {
      v2 = setInterval(() => {
        value2.value <= 9 && value2.value > 0 ? value2.value-- : (value2.value = 0)
      }, 100)
    }
    if (newV == 1) {
      setInterval(() => {
        value1.value >= 1 ? (value1.value = 1) : value1.value++
      }, 1000)
    }
    if (newV == 4) {
      clearInterval(v2)
      setInterval(() => {
        value2.value >= 0 ? value2.value++ : (value2.value = 9)
      }, 200)
    }
    if (newV == 5) {
      // clearInterval(v2)
      setInterval(() => {
        value3.value < 4 ? (value3.value = 4) : value3.value--
      }, 1000)
    }
  }
)

// const process = ref(1)
console.log(store.currentSpeed)
let demo = null
onMounted(() => {
  demo = new CountUp('infoText', store.currentSpeed, { startVal: 0 })
  demo.start()
})
watch(
  () => store.currentSpeed,
  (newV, oldV) => {
    console.log(newV, 'newV')
    demo.update(newV)
  }
)
// setInterval(() => {
//   demo.update(1000)
// }, 2000)
// setInterval(() => {
//   // process.value >= 9 ? (process.value = 0) : process.value++
//   speed.value >= 40 ? (speed.value = 0) : speed.value++
// }, 1000)
const numPercent = computed(() => {
  return (store.currentSpeed / 40) * 356
})
const numHeight = computed(() => {
  return (store.currentSpeed / 40) * 100 + '%'
})
</script>

<style lang="scss" scoped>
.left1 {
  position: absolute;
  top: 196px;
  left: 66px;
  width: 315px;
  height: 159px;
  background: url('./bg1.png') no-repeat;
  background-size: contain;
  overflow: hidden;
  .line {
    width: 274px;
    height: 159px;
    position: absolute;
    left: 0px;
    top: 0;
    overflow: hidden;
    .info {
      width: 274px;
      height: 159px;
      position: absolute;
      left: 0px;
      top: 0;
      background: linear-gradient(90deg, rgba(0, 255, 51, 0) 43%, rgba(#00ff33, 0.5) 211%);
      border-right: 3px solid rgb(59, 255, 167);
      animation: radar-beam 5s linear infinite;
    }
  }
}
@keyframes radar-beam {
  0% {
    transform: translateX(-100%);
  }
  100% {
    transform: translateX(100%);
  }
}
.left2 {
  position: absolute;
  top: 228px;
  left: 112px;
  .radar {
    overflow: hidden;
    position: relative;
    margin: 200px auto;
    width: 200px;
    height: 200px;
    border-radius: 50%;
    background: transparent;
    border: 1px solid #5ef2ff;
    box-sizing: border-box;
    box-shadow: 25px 25px 75px rgba(0, 0, 0, 0.55);
    border: 1px solid #333;
  }

  .radar::before {
    content: '';
    position: absolute;
    inset: 20px;
    background: transparent;
    border: 1px dashed#444;
    border-radius: 50%;
    box-shadow:
      inset -5px -5px 25px rgba(0, 0, 0, 0.25),
      inset 5px 5px 35px rgba(0, 0, 0, 0.25);
  }

  .radar::after {
    content: '';
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    width: 50px;
    height: 50px;
    border-radius: 50%;
    border: 1px dashed#444;
    box-shadow:
      inset -5px -5px 25px rgba(0, 0, 0, 0.25),
      inset 5px 5px 35px rgba(0, 0, 0, 0.25);
  }

  .fan {
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    border-radius: 50%;
    box-sizing: border-box;
    border: 1px dashed#444;
    width: 100px;
    height: 100px;
  }

  .fan::after {
    content: '';
    display: block;
    background-image: linear-gradient(44deg, rgba(0, 255, 51, 0) 50%, rgba(#00ff33, 0.8) 100%);
    width: 100%;
    height: 100%;
    position: absolute;
    top: -50%;
    left: -50%;
    transform: translate(-50%, -50%);
    animation: radar-beam2 5s infinite;
    animation-timing-function: linear;
    transform-origin: bottom right;
    border-radius: 100% 0 0 0;
  }

  @keyframes radar-beam2 {
    0% {
      transform: rotate(0deg);
    }

    100% {
      transform: rotate(360deg);
    }
  }
}
.right1 {
  position: absolute;
  top: 221px;
  right: 249px;
  width: 80px;
  height: 100px;
  .content {
    #infoText,
    :deep(#infoText font) {
      position: absolute;
      top: 2px;
      width: 100px;
      height: 100px;
      left: 4px;
      font-family: MyFont !important;
      font-size: 64px;
      letter-spacing: 0.12em;
      text-shadow: 0px 0px 18px rgba(0, 191, 255, 1);
      color: #ffffff;
    }
    .svg {
      position: absolute;
      top: -1px;
      left: 98px;
      transform: scale(1.5);
    }
    .process {
      position: absolute;
      top: -40px;
      right: -150px;
      background: url('./bg3.png') no-repeat;
      background-size: contain;
      width: 21px;
      height: 151px;
      .info {
        position: absolute;
        top: 0;
        left: 0;
        background: url('./bg2.png') no-repeat;
        background-size: cover;
        width: 21px;
        transition: height 0.6s linear;
        height: v-bind(numHeight);
      }
    }
  }
}

#move {
  /* transform-origin: revert; */
  transform: rotate(202deg);
  transform-origin: 63px 68px;
  stroke-width: 4;
  stroke-dasharray: v-bind(numPercent), 420;
  transition: all 0.3s linear;
}
.right2 {
  position: absolute;
  top: 455px;
  right: 185px;
  width: 80px;
  height: 100px;
  .item1 {
    position: absolute;
    top: 0;
    left: 0;
  }
  .item2 {
    position: absolute;
    top: 0;
    left: 75px;
  }
  .item3 {
    position: absolute;
    top: 0;
    left: 150px;
  }
}
</style>
